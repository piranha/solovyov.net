title: –û–†–ú–∏ –Ω–∞ —Å–º—ñ—Ç–Ω–∏–∫!
date: 2023-01-09 18:35:49
uuid: 068ad8b6-1d2a-4575-8d20-75bbcf9ec2ee
tgid: 240
tags: channel
----

<p><a href="https://t.me/bitethebyte/226">–ê–≤—Ç–æ—ñ–Ω–∫—Ä–µ–º–µ–Ω—Ç</a> –∑–∞–π—à–æ–≤ –¥–æ–±—Ä–µ ‚Äî –¥–∞–≤–∞–π—Ç–µ —ñ –ø–æ –û–†–ú–∞–º –ø—Ä–æ–π–¥–µ–º–æ—Å—è? üòù</p>

<p>–ù–∞—â–æ –≤–æ–Ω–∏ –Ω–∞–º? –û–†–ú–∏ —ñ—Å–Ω—É—é—Ç—å –¥–ª—è —Ä–æ–∑–≤&#39;—è–∑–∞–Ω–Ω—è –¥–≤–æ—Ö –ø—Ä–æ–±–ª–µ–º: –∫–æ–º–ø–æ–∑–∏—Ü—ñ—ó —Ç–∞ —Ç–æ–≥–æ, —â–æ —Ä–µ–ª—è—Ü—ñ–π–Ω—ñ –¥–∞–Ω—ñ —Ñ–æ—Ä–º–æ—é –≤—ñ–¥—Ä—ñ–∑–Ω—è—é—Ç—å—Å—è –≤—ñ–¥ –æ–±‚Äò—î–∫—Ç—ñ–≤. –ó –¥—Ä—É–≥–∏–º –Ω–∞—á–µ —ñ–Ω—Ç—É—ñ—Ç–∏–≤–Ω–æ –∑—Ä–æ–∑—É–º—ñ–ª–æ, –∞ –∑ –∫–æ–º–ø–æ–∑–∏—Ü—ñ—î—é —ñ—Å—Ç–æ—Ä—ñ—è –≤ —Ç–æ–º—É, —â–æ SQL —Å–∞–º –ø–æ —Å–æ–±—ñ –∫–æ–º–ø–æ–Ω—É—î—Ç—å—Å—è –ø–æ–≥–∞–Ω–æ, –∞ —É –±—ñ–ª—å—à–æ—Å—Ç—ñ –º–æ–≤ —Ü–µ —â–µ –π –ø—Ä–æ—Å—Ç–æ —Ä—è–¥–æ—á–∫–∏ —Ç–µ–∫—Å—Ç—É ‚Äì —Ç–æ –≤–∑–∞–≥–∞–ª—ñ –≥–∞–ø–ª–∏–∫.</p>

<p>–Ø–∫–±–∏ –¥–∏–∑–∞–π–Ω–µ—Ä–∏ SQL&#39;—é –¥—É–º–∞–ª–∏ –Ω–µ —Ç—ñ–ª—å–∫–∏ –∑–∞ —á–∏—Ç–∞—î–º—ñ—Å—Ç—å, –∞ —â–µ –π –∑–∞ –∫–æ–º–ø–æ–Ω—É–≤–∞–Ω–Ω—è –∫—É—Å–æ—á–∫—ñ–≤ –±–µ–∑ –∑–º—ñ–Ω, –∫—É–¥–∏ –± –º–µ–Ω—à–µ –ø—Ä–æ–±–ª–µ–º –º–∏ –∑–∞—Ä–∞–∑ –º–∞–ª–∏... –ó —ñ–Ω—à–æ—ó —Å—Ç–æ—Ä–æ–Ω–∏ –º–∞—î–º–æ Elasticsearch, —Ç–∞–º –¥—É–º–∞–ª–∏ –∑–∞ –∫–æ–º–ø–æ–∑–∏—Ü—ñ—é —ñ –Ω–µ –¥—É–º–∞–ª–∏ –∑–∞ —á–∏—Ç–∞—î–º—ñ—Å—Ç—å ‚Äî –Ω–µ —Ç–∞–∫ —â–æ–± —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∫—Ä–∏—Ç–∏—á–Ω–æ –∫—Ä–∞—â–∏–º –±—É–≤. üòÅ</p>

<p>–ü–æ–≤–µ—Ä–Ω–µ–º–æ—Å—è –¥–æ –Ω–∞—à–∏—Ö –±–∞—Ä–∞–Ω—ñ–≤! –ó–¥–∞–ª–µ–∫—É —Ü—è —ñ–¥–µ—è –∑–¥–∞—î—Ç—å—Å—è —Ä–æ–∑—É–º–Ω–æ—é. –°–∫–æ–º–ø–æ–Ω—É–≤–∞–≤ –∑–Ω–∞—á –∑ –∫—ñ–ª—å–∫–æ—Ö —á–∞—Å—Ç–∏–Ω –∑–∞–ø–∏—Ç, –æ—Ç—Ä–∏–º–∞–≤ –Ω–∞ –≤–∏—Ö–æ–¥—ñ —Å–≤–æ—ó –æ–±&#39;—î–∫—Ç–∏, —Ñ–∞–Ω—Ç–∞—Å—Ç—ñ–∫–∞ –∂! –ß–∏ –ø–æ–≥–∞–Ω–æ? –î—É–ñ–µ –ø–û–≥–ê–Ω–û! üò°</p>

<ul>
	<li>–ö–æ–∂–µ–Ω ORM –≤–∏—Ä—ñ—à—É—î N+1 –ø–æ-—Å–≤–æ—î–º—É, —ñ —Ç—Ä–µ–±–∞ –±—É—Ç–∏ –¥—É–∂–µ –æ–±–µ—Ä–µ–∂–Ω–∏–º –ø—É–ø—Å—ñ–∫–æ–º, —â–æ–±–∏ –Ω–µ –Ω–∞–ª–∞–∂–∞—Ç–∏. –Ø–∫—â–æ –≤–∞—à—ñ —Ä—É–∫–∏ —Ç—è–≥–Ω—É—Ç—å—Å—è –Ω–∞–ø–∏—Å–∞—Ç–∏ &quot;–∞ —è –æ—Ç –Ω–∞–≤—ñ—Ç—å –Ω–µ –Ω–∞–ø—Ä—É–∂—É—é—Å—å&quot;, —Ç–æ —É –≤–∞—Å —Å—Ç–æ–∫–≥–æ–ª—å–º—Å–∫–∏–π —Å–∏–Ω–¥—Ä–æ–º, —è–∫ —É –º–µ–Ω–µ –∑ –¥–∏–Ω–∞–º—ñ—á–Ω–æ—é —Ç–∏–ø—ñ–∑–∞—Ü—ñ—î—é. üíØ</li>
	<li>–ú–∞–ª–æ –Ω–µ –≤—Å—ñ –û–†–ú–∏ –¥–∞—é—Ç—å –ª–µ–≥–∫–∏–π —Å–ø–æ—Å—ñ–± –¥–æ–±—Ä–∞—Ç–∏—Å—è –≤—ñ–¥ –¥–∞–Ω–∏—Ö –≤ –ø–∞–º&#39;—è—Ç—ñ –¥–æ –¥–∞–Ω–∏—Ö –≤ –±–∞–∑—ñ. <code>book.author</code> ‚Äî —ñ –º–∞—î–º–æ —â–µ –æ–¥–∏–Ω –∑–∞–ø–∏—Ç –≤ –±–∞–∑—É. –ü—Ä–æ–≥—Ä–∞–º—ñ—Å—Ç —â–∞—Å–ª–∏–≤–∏–π, –±–æ –∫–æ–¥—É –Ω–µ –ø–∏—Å–∞–≤, –∑–∞–º–æ–≤–Ω–∏–∫ —â–∞—Å–ª–∏–≤–∏–π, –±–æ –∞–≤—Ç–æ—Ä –ø–æ–∫–∞–∑—É—î—Ç—å—Å—è, –±–∞–∑–∞ —â–∞—Å–ª–∏–≤–∞, –±–æ –ø—Ä–æ –Ω–µ—ó –Ω–µ –∑–∞–±—É–≤–∞—é—Ç—å. –í –ø–æ–≥–∞–Ω–∏—Ö –≤–∏–ø–∞–¥–∫–∞—Ö –Ω–µ –∑–∞–±—É–≤–∞—é—Ç—å –ø–æ 300-400 —Ä–∞–∑ –Ω–∞ —Å—Ç–æ—Ä—ñ–Ω–∫—É.</li>
	<li>–†–µ–ª—è—Ü—ñ–π–Ω—ñ –¥–∞–Ω—ñ –¥—ñ–π—Å–Ω–æ –Ω–µ –¥—É–∂–µ –ª—è–≥–∞—é—Ç—å –Ω–∞ –æ–±&#39;—î–∫—Ç–Ω—ñ –º–æ–¥–µ–ª—ñ, –æ—Å–æ–±–ª–∏–≤–æ —ó—Ö –¥–∏–Ω–∞–º—ñ—á–Ω—ñ—Å—Ç—å. –ü–æ–ø—Ä–∏ —Ç–µ, —â–æ –≤—Å—è–∫—ñ –ü–∞–π—Ç–æ–Ω–∏ ‚Äî –¥–∏–Ω–∞–º—ñ—á–Ω—ñ, –æ—Ä–º—ñ–≤—Å—å–∫—ñ –º–æ–¥–µ–ª—ñ –¥–æ–≤–æ–ª—ñ-—Ç–∞–∫–∏ —Å—Ç–∞—Ç–∏—á–Ω—ñ. –¢–æ–º—É –∑–≤–∏—á–∞–π–Ω–∏–π –ø—Ä–æ–≥—Ä–∞–º—ñ—Å—Ç —É–Ω–∏–∫–∞—î –∞–≥—Ä–µ–≥–∞—Ü—ñ–π —ñ –ø—ñ–¥—Ä–∞—Ö—É–Ω–∫—ñ–≤ –≤ –±–∞–∑—ñ. –Ñ –∫–ª—å–æ–≤–∞ –≤—ñ–¥–º–∞–∑–∫–∞ ‚Äî —Ü–µ –∂ –Ω–µ web-scale, –∫—Ä–∞—â–µ –º–∏ –∑–∞–≤–µ–¥–µ–º–æ —Å–æ–±—ñ –∫—ñ–ª—å–∫–∞ —Ä–µ–ø–ª—ñ–∫ —ñ —Ä–æ–∑–º–∞–∂–µ–º–æ –ø–æ –Ω–∏—Ö –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è. –ù—ñ—á–æ–≥–æ, —â–æ —Å–µ—Ç–∞–ø —Å–∫–ª–∞–¥–Ω—ñ—à–µ —Å—Ç–∞–≤, –∫–æ–º–ø&#39;—é—Ç–µ—Ä–∏ –∑–∞–ª—ñ–∑–Ω—ñ, –Ω–µ –ø–ª–∞—á—É—Ç—å—Å—è.</li>
	<li>–ù–µ –∫–æ–Ω—Ü–µ–ø—Ç—É–∞–ª—å–Ω–∞ –ø—Ä–æ–±–ª–µ–º–∞, –∞–ª–µ –∑–∞–∑–≤–∏—á–∞–π ORM ‚Äî —Ü–µ –¥—É–∂–µ –±–∞–≥–∞—Ç–æ –∫–æ–¥—É. HoneySQL ‚Äî —Ü–µ 3 —Ç–∏—Å—è—á—ñ —Ä—è–¥–∫—ñ–≤, django.db ‚Äî 32k, sqlalchemy.orm ‚Äî 36k (—É–≤–µ—Å—å sqla ‚Äî 137k!), —ñ —Ç–∞–∫ –¥–∞–ª—ñ. –ú–æ–∂–µ—Ç–µ –ø–æ–¥–∏–≤–∏—Ç–∏—Å—è –Ω–∞ —Å–≤—ñ–π. –¢–∞–∫ –æ—Ç, –¥–ª—è –≤—ñ–¥–Ω–æ—Å–Ω–æ –ø—Ä–æ—Å—Ç–∏—Ö —Å—Ç–æ—Ä—ñ–Ω–æ–∫ –û–†–ú–∏ –º–æ–∂—É—Ç—å –∑–∞–π–º–∞—Ç–∏ 30-60% —á–∞—Å—É –≤–∏–∫–æ–Ω–∞–Ω–Ω—è. –Ø –∫–æ–ª–∏—Å—å –ø—Ä–∏—à–≤–∏–¥—à–∏–≤ —Å–∞–π—Ç –≤ –¥–≤–∞ —Ä–∞–∑–∏ —Ç–∏–º, —â–æ –∞–ø–≥—Ä–µ–π–¥–Ω—É–≤ –∞–ª—Ö—ñ–º—ñ—é –∑ 0.8 –¥–æ 1.0.</li>
</ul>

<p>–ü—ñ–¥—Å—É–º–æ–≤—É—é—á–∏, —è –º–∞—é –¥–≤—ñ –ø—Ä–µ—Ç–µ–Ω–∑—ñ—ó –¥–æ –û–†–ú—ñ–≤:</p>

<ul>
	<li>–ü–æ–≥–∞–Ω—ñ –ø—Ä–∞–∫—Ç–∏–∫–∏ –Ω–∞ –Ω–∏—Ö —Ä–µ–∞–ª—ñ–∑–æ–≤—É–≤–∞—Ç–∏ –¥—É–∂–µ –ª–µ–≥–∫–æ —ñ –ø—Ä–æ–≥—Ä–∞–º—ñ—Å—Ç–∏ –¥–æ —Ç–æ–≥–æ —Ç—è–∂—ñ—é—Ç—å (—á–∏—Ç–∞–π: –ø–∏—à—É—Ç—å –ø–æ–≥–∞–Ω–æ), –∞ –±—É–¥—å-—è–∫–µ –ø–æ–∫—Ä–∞—â–µ–Ω–Ω—è –∑–∞–ø–∏—Ç—ñ–≤ —É—Å–∫–ª–∞–¥–Ω—é—î—Ç—å—Å—è: –≤—Å—è–∫—ñ <code>.select_related</code> —á–∏ <code>.prefetch_related</code> (–∑–Ω–∞—î—Ç–µ –≤ —á–æ–º—É —Ä—ñ–∑–Ω–∏—Ü—è, –≥–∞?) –≤ –î–∂–∞–Ω–∑—ñ, <code>.options(...)</code> –≤ sqla. –Ø –Ω–µ —Ö–æ—á—É –Ω–∞–≤—ñ—Ç—å –∑–Ω–∞—Ç–∏, —â–æ —Ç–∞–º –Ω–∞ –î–∂–∞–≤—ñ.</li>
	<li>–†–µ–ª—è—Ü—ñ–π–Ω–∞ –º–æ–¥–µ–ª—å –∑–∞—Ö–æ–¥–∏—Ç—å –ø—Ä–æ–≥—Ä–∞–º—ñ—Å—Ç–∞–º –Ω–∞ –û–†–ú–∞—Ö –¥—É–∂–µ —Ç–∞–∫ –Ω–µ–ø–µ–≤–Ω–æ —ñ –ø–æ—Ç—ñ–º —ó—Ö —Ç—Ä–µ–±–∞ –ø–µ—Ä–µ–≤—á–∞—Ç–∏. –ó–∞–º—ñ—Å—Ç—å —Ç–æ–≥–æ –¥–∞—Ç–∏ —Ä–æ–∑—ñ–±—Ä–∞—Ç–∏—Å—è —É –±–∞–∑–æ–≤–∏—Ö –ø—Ä–∏–Ω—Ü–∏–ø–∞—Ö —ñ –¥–∞—Ç–∏ –Ω–∏–º–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—Ç–∏—Å—è, –û–†–ú–∏ –∑–∞–∫—Ä–∏–≤–∞—é—Ç—å —ó—Ö —Å–æ–±–æ—é, —è–∫ –§—Ä–∞–Ω–∫–µ–π–Ω—à—Ç–µ–π–Ω –∑ –¥–∞—Ö–æ–º^W –∞–±—Å—Ç—Ä–∞—Ü—ñ—î—é, —â–æ –ø—Ä–æ—Ç—ñ–∫–∞—î.</li>
</ul>

<p>–¢–æ —â–æ —Ä–æ–±–∏—Ç–∏ –±—ñ–¥–Ω–µ—Å–µ–Ω—å–∫–æ–º—É –ø—Ä–æ–≥—Ä–∞–º—ñ—Å—Ç—É? –ü–æ-–ø–µ—Ä—à–µ, –∑–º–∏—Ä–∏—Ç–∏—Å—è, —â–æ –Ω–∞–π–∫—Ä–∞—â–∏–π —Å–ø–æ—Å—ñ–± —Ä–æ–±–∏—Ç–∏ –∑–∞–ø–∏—Ç–∏ –≤ –ë–î —Ü–µ —â–æ? –ê–≤–∂–µ–∂, —Ü–µ <a href="https://github.com/seancorfield/honeysql">HoneySQL –Ω–∞ Clojure</a>, –∞ —â–æ –≤–∏ –æ—á—ñ–∫—É–≤–∞–ª–∏. :-) –¶–µ –≥–∞—Ä–Ω–∏–π —Å–ø–æ—Å—ñ–± –æ—Ç—Ä–∏–º–∞—Ç–∏ –∫–æ–º–ø–æ–∑–∏—Ü—ñ—é, —è–∫–æ—ó –Ω–µ–º–∞, –∫–æ–ª–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—à —Å—Ç—Ä–æ–∫–∏, –∞–ª–µ –Ω–µ –≤—ñ–¥—Ä–∏–≤–∞—Ç–∏—Å—è –≤—ñ–¥ –±–∞–∑–æ–≤–æ–≥–æ SQL –∑–∞–Ω–∞–¥—Ç–æ —Å–∏–ª—å–Ω–æ ‚Äî —ñ –≤—Å—ñ –º–æ–∂–ª–∏–≤–æ—Å—Ç—ñ SQL –Ω–∞ –º—ñ—Å—Ü—ñ, —ñ –±–æ–ª—ñ –≤ —Å—ñ–¥–Ω–∏—Ü—è—Ö –≤—ñ–¥ –∫–æ–Ω–∫–∞—Ç–µ–Ω–∞—Ü—ñ—ó –Ω–µ–º–∞.</p>

<p>–£ SQLAlchemy —î –±–∞–∑–æ–≤–∞ –∞–ª–≥–µ–±—Ä–∞ —Ñ—É–Ω–∫—Ü—ñ—è–º–∏, –∞ –Ω–µ —Ç—ñ–ª—å–∫–∏ ORM, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥, –∞–ª–µ –≤–æ–Ω–æ –Ω–µ –µ—Ä–≥–æ–Ω–æ–º—ñ—á–Ω–æ. –ù–µ –∑–Ω–∞—é, —è–∫ –ø–æ–∫—Ä–∞—â–∏—Ç–∏, —â–æ–± –Ω–∏–º –ø—Ä–∏—î–º–Ω–æ –±—É–ª–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—Ç–∏—Å—è ‚Äî –º–æ–∂–µ –≤ –∫–æ–≥–æ—Å—å —î –∫–æ—Ä–∏—Å–Ω—ñ –¥—É–º–∫–∏?</p>

<p>–ù—É –∞ –ø–æ-–¥—Ä—É–≥–µ, –∫–æ–ª–∏ –≤—Å—ñ –ø–æ–∫—Ä–æ–≤–∏ –∑—ñ—Ä–≤–∞–Ω—ñ, —Ç—Ä–µ–±–∞ –¥—É–º–∞—Ç–∏ –π –µ–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—É–≤–∞—Ç–∏. –Ø –≤–ø–µ–≤–Ω–µ–Ω–∏–π —â–æ –≤—Å—é–¥–∏ –º–æ–∂–Ω–∞ –∑—Ä–æ–±–∏—Ç–∏ –∫—Ä–∞—â–µ, –Ω—ñ–∂ —Å—Ç–∞—Ç—É—Å-–∫–≤–æ (except you know where, ha-ha).</p>

<p>P.S. –¢—ñ–ª—å–∫–∏ –Ω–µ –∑–≥–∞–¥—É–π—Ç–µ –º–æ–Ω–≥–∏ –≤ –∫–æ–º–µ–Ω—Ç–∞—Ö, –±—É–¥—å –ª–∞—Å–∫–∞.</p>