title: Сноски и обновление пингбека
date: 2007-11-04 18:43:14
tags: pingback, blog, news, markdown, python, programming
----


Как я и [писал][1], я решил добавить поддержку сносок. Оказалось это совсем просто, потому что [порт][2] Markdown на Python уже имеет такой плагин. Потому все изменения свелись к тому, что кинул `mdx_markdown.py` в каталог проекта и немножко [переписал][3] свою функцию `text_to_html`. Правда, пришлось немного поправить код самого плагина, чтобы сноски выводились так, как хочется мне, а не как придумал себе автор. :) Должен сказать, что генерация DOM в питоновском коде - то ещё уродство, лучше уж какие-то простенькие темплейты, что ли... :\

Вторая и главная новость состоит в том, что я добавил модель `PingbackClient`, которая запоминает те адреса, которые уже пинговались, и просто не даёт их пинговать при редактировании поста - чтоб не ждать каждый раз, пока оно пройдёт все урлы. Кроме того, это же позволит следить за тем, куда же таки дошли пинги. :) А ещё я закинул всю реализацию как отдельный [проект][4] на Google Code. :)

P.S. Кстати, замечания и дополнения привествуются. :) А то чувствую, ещё пару раз гляну на `ping`, и перепишу её. Уж больно ужасно вышло. :-)

[1]: https://solovyov.net/blog/2007/related-objects/
[2]: http://www.freewisdom.org/projects/python-markdown/
[3]: http://trac.piranha.org.ua/browser/byteflow/lib/helpers.py
[4]: http://code.google.com/p/django-pingback/ "Так его с самого GC проще найти будет"
